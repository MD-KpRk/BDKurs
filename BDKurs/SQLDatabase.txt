use master
alter database LibraryDB set single_user with rollback immediate 
drop database IF EXISTS LibraryDB
GO

CREATE DATABASE LibraryDB;
GO

USE LibraryDB;
GO

SELECT SYSTEM_USER;
GO
-- Таблица Gender
CREATE TABLE Genders (
    GenderID INT PRIMARY KEY IDENTITY(1,1),
    [Name] VARCHAR(10) NOT NULL
);
GO

-- Таблица Publishers
CREATE TABLE Publishers (
    PublisherID INT PRIMARY KEY IDENTITY(1,1),
    [Name] VARCHAR(120) NOT NULL,
    [Address] VARCHAR(120),
    Phone VARCHAR(30),
    Email VARCHAR(30)
);
GO

-- Таблица Authors
CREATE TABLE Authors (
    AuthorID INT PRIMARY KEY IDENTITY(1,1),
    FirstName VARCHAR(30) NOT NULL,
    LastName VARCHAR(30) NOT NULL,
    MiddleName VARCHAR(30),
    BirthDate DATE,
    Biography VARCHAR(200),
    GenderID INT FOREIGN KEY REFERENCES Genders(GenderID)
);
GO

-- Таблица Genres
CREATE TABLE Genres (
    GenreID INT PRIMARY KEY IDENTITY(1,1),
    [Name] VARCHAR(20) NOT NULL
);
GO

-- Таблица Statuses
CREATE TABLE Statuses (
    StatusID INT PRIMARY KEY IDENTITY(1,1),
    [Name] VARCHAR(20) NOT NULL
);
GO

-- Таблица Books
CREATE TABLE Books (
    ISBN VARCHAR(15) PRIMARY KEY,
    Title VARCHAR(120) NOT NULL,
    PublicationYear INT,
    PublisherID INT FOREIGN KEY REFERENCES Publishers(PublisherID),
    AuthorID INT FOREIGN KEY REFERENCES Authors(AuthorID),
    StatusID INT FOREIGN KEY REFERENCES Statuses(StatusID),
    GenreID INT FOREIGN KEY REFERENCES Genres(GenreID)
);
GO

-- Таблица ReaderCategories
CREATE TABLE ReaderCategories (
    ReaderCategoryID INT PRIMARY KEY IDENTITY(1,1),
    [Name] VARCHAR(30) NOT NULL
);
GO

-- Таблица Readers
CREATE TABLE Readers (
    ReaderID INT PRIMARY KEY IDENTITY(1,1),
    FirstName VARCHAR(30) NOT NULL,
    LastName VARCHAR(30) NOT NULL,
    MiddleName VARCHAR(30),
    BirthDate DATE,
    [Address] VARCHAR(120),
    Phone VARCHAR(30),
    Email VARCHAR(30),
    GenderID INT FOREIGN KEY REFERENCES Genders(GenderID),
    ReaderCategoryID INT FOREIGN KEY REFERENCES ReaderCategories(ReaderCategoryID)
);
GO

-- Таблица Positions
CREATE TABLE Positions (
    PositionID INT PRIMARY KEY IDENTITY(1,1),
    [Name] VARCHAR(30) NOT NULL
);
GO

-- Таблица AccessCategories
CREATE TABLE AccessCategories (
    AccessCategoryID INT PRIMARY KEY IDENTITY(1,1),
    [Name] VARCHAR(30) NOT NULL
);
GO

-- Таблица Employees
CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY IDENTITY(1,1),
    FirstName VARCHAR(30) NOT NULL,
    LastName VARCHAR(30) NOT NULL,
    MiddleName VARCHAR(30),
	Passw VARCHAR(20) NOT NULL,
    Phone VARCHAR(30),
    Email VARCHAR(30),
    GenderID INT FOREIGN KEY REFERENCES Genders(GenderID),
    PositionID INT FOREIGN KEY REFERENCES Positions(PositionID),
    AccessCategoryID INT FOREIGN KEY REFERENCES AccessCategories(AccessCategoryID)
);
GO

-- Таблица BookOrder
CREATE TABLE BookOrders (
    BookOrderID INT PRIMARY KEY IDENTITY(1,1),
    BookOrderDate DATE NOT NULL,
    ReturnDate DATE NOT NULL,
    ActualReturnDate DATE,
    BookID VARCHAR(15) FOREIGN KEY REFERENCES Books(ISBN),
    ReaderID INT FOREIGN KEY REFERENCES Readers(ReaderID),
    EmployeeID INT FOREIGN KEY REFERENCES Employees(EmployeeID)
);
GO

INSERT INTO Genders ([Name]) VALUES ('Male');
INSERT INTO Genders ([Name]) VALUES ('Female');
INSERT INTO Genders ([Name]) VALUES ('Other');
GO

INSERT INTO Publishers (Name, Address, Phone, Email) VALUES 
('Penguin Random House', '1745 Broadway, New York, NY 10019', '212-782-9000', 'contact@penguinrandomhouse.com'),
('HarperCollins', '195 Broadway, New York, NY 10007', '212-207-7000', 'info@harpercollins.com'),
('Simon & Schuster', '1230 Avenue of the Americas, New York, NY 10020', '212-698-7000', 'info@simonandschuster.com');
GO

INSERT INTO Authors (FirstName, LastName, MiddleName, BirthDate, Biography, GenderID) VALUES 
('George', 'Orwell', NULL, '1903-06-25', 'English novelist and essayist, journalist and critic.', 1),
('J.K.', 'Rowling', NULL, '1965-07-31', 'British author, best known for the Harry Potter series.', 2),
('Jane', 'Austen', NULL, '1775-12-16', 'English novelist known for her six major novels.', 2);
GO

INSERT INTO Genres ([Name]) VALUES ('Fiction');
INSERT INTO Genres ([Name]) VALUES ('Non-Fiction');
INSERT INTO Genres ([Name]) VALUES ('Science Fiction');
INSERT INTO Genres ([Name]) VALUES ('Fantasy');
GO

INSERT INTO Statuses ([Name]) VALUES ('Available');
INSERT INTO Statuses ([Name]) VALUES ('Checked Out');
INSERT INTO Statuses ([Name]) VALUES ('Reserved');
GO

INSERT INTO Books (ISBN, Title, PublicationYear, PublisherID, AuthorID, StatusID, GenreID) VALUES 
('978-0451524935', '1984', 1949, 1, 1, 1, 3),
('978-0747532743', 'Harry Potter and the Philosophers Stone', 1997, 2, 2, 1, 4),
('978-0141439518', 'Pride and Prejudice', 1813, 3, 3, 1, 1);
GO

INSERT INTO ReaderCategories ([Name]) VALUES ('Adult');
INSERT INTO ReaderCategories ([Name]) VALUES ('Child');
INSERT INTO ReaderCategories ([Name]) VALUES ('Teen');
GO

INSERT INTO Readers (FirstName, LastName, MiddleName, BirthDate, Address, Phone, Email, GenderID, ReaderCategoryID) VALUES 
('John', 'Doe', NULL, '1990-05-15', '123 Elm Street, Springfield', '555-1234', 'john.doe@example.com', 1, 1),
('Jane', 'Smith', NULL, '1985-08-22', '456 Oak Avenue, Springfield', '555-5678', 'jane.smith@example.com', 2, 2),
('Emily', 'Johnson', NULL, '2000-11-30', '789 Maple Road, Springfield', '555-8765', 'emily.johnson@example.com', 2, 3);
GO

INSERT INTO Positions (Name) VALUES ('Librarian');
INSERT INTO Positions (Name) VALUES ('Assistant');
INSERT INTO Positions (Name) VALUES ('Manager');
GO

INSERT INTO AccessCategories ([Name]) VALUES ('Admin');
INSERT INTO AccessCategories ([Name]) VALUES ('Staff');
INSERT INTO AccessCategories ([Name]) VALUES ('Guest');
GO

INSERT INTO Employees (FirstName, LastName, MiddleName, Phone, Email, GenderID, PositionID, AccessCategoryID) VALUES 
('Alice', 'Brown', NULL, '555-1111', 'alice.brown@example.com', 2, 1, 1),
('Bob', 'White', NULL, '555-2222', 'bob.white@example.com', 1, 2, 2),
('Charlie', 'Green', NULL, '555-3333', 'charlie.green@example.com', 1, 3, 3);
GO

INSERT INTO BookOrders (BookOrderDate, ReturnDate, ActualReturnDate, BookID, ReaderID, EmployeeID) VALUES 
('2024-08-01', '2024-08-15', NULL, '978-0451524935', 1, 1),
('2024-08-02', '2024-08-16', '2024-08-14', '978-0747532743', 2, 2),
('2024-08-03', '2024-08-17', NULL, '978-0141439518', 3, 3);
GO

SELECT * FROM Genders

Delete * from 
